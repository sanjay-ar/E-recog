{"ast":null,"code":"import { __assign, __awaiter, __generator } from \"tslib\";\nimport { HttpRequest, HttpResponse } from \"@aws-sdk/protocol-http\";\nimport { getSkewCorrectedDate } from \"./utils/getSkewCorrectedDate\";\nimport { getUpdatedSystemClockOffset } from \"./utils/getUpdatedSystemClockOffset\";\nexport var awsAuthMiddleware = function (options) {\n  return function (next, context) {\n    return function (args) {\n      var _a, _b, _c;\n\n      return __awaiter(this, void 0, void 0, function () {\n        var authScheme, signer, output, _d, _e, dateHeader;\n\n        var _f;\n\n        return __generator(this, function (_g) {\n          switch (_g.label) {\n            case 0:\n              if (!HttpRequest.isInstance(args.request)) return [2, next(args)];\n              authScheme = (_c = (_b = (_a = context.endpointV2) === null || _a === void 0 ? void 0 : _a.properties) === null || _b === void 0 ? void 0 : _b.authSchemes) === null || _c === void 0 ? void 0 : _c[0];\n              return [4, options.signer(authScheme)];\n\n            case 1:\n              signer = _g.sent();\n              _d = next;\n              _e = [__assign({}, args)];\n              _f = {};\n              return [4, signer.sign(args.request, {\n                signingDate: getSkewCorrectedDate(options.systemClockOffset),\n                signingRegion: context[\"signing_region\"],\n                signingService: context[\"signing_service\"]\n              })];\n\n            case 2:\n              return [4, _d.apply(void 0, [__assign.apply(void 0, _e.concat([(_f.request = _g.sent(), _f)]))]).catch(function (error) {\n                var _a;\n\n                var serverTime = (_a = error.ServerTime) !== null && _a !== void 0 ? _a : getDateHeader(error.$response);\n\n                if (serverTime) {\n                  options.systemClockOffset = getUpdatedSystemClockOffset(serverTime, options.systemClockOffset);\n                }\n\n                throw error;\n              })];\n\n            case 3:\n              output = _g.sent();\n              dateHeader = getDateHeader(output.response);\n\n              if (dateHeader) {\n                options.systemClockOffset = getUpdatedSystemClockOffset(dateHeader, options.systemClockOffset);\n              }\n\n              return [2, output];\n          }\n        });\n      });\n    };\n  };\n};\n\nvar getDateHeader = function (response) {\n  var _a, _b, _c;\n\n  return HttpResponse.isInstance(response) ? (_b = (_a = response.headers) === null || _a === void 0 ? void 0 : _a.date) !== null && _b !== void 0 ? _b : (_c = response.headers) === null || _c === void 0 ? void 0 : _c.Date : undefined;\n};\n\nexport var awsAuthMiddlewareOptions = {\n  name: \"awsAuthMiddleware\",\n  tags: [\"SIGNATURE\", \"AWSAUTH\"],\n  relation: \"after\",\n  toMiddleware: \"retryMiddleware\",\n  override: true\n};\nexport var getAwsAuthPlugin = function (options) {\n  return {\n    applyToStack: function (clientStack) {\n      clientStack.addRelativeTo(awsAuthMiddleware(options), awsAuthMiddlewareOptions);\n    }\n  };\n};\nexport var getSigV4AuthPlugin = getAwsAuthPlugin;","map":{"version":3,"sources":["/Users/sanjayar/Desktop/moody-main copy/node_modules/@aws-sdk/client-lex-runtime-v2/node_modules/@aws-sdk/middleware-signing/dist-es/middleware.js"],"names":["__assign","__awaiter","__generator","HttpRequest","HttpResponse","getSkewCorrectedDate","getUpdatedSystemClockOffset","awsAuthMiddleware","options","next","context","args","_a","_b","_c","authScheme","signer","output","_d","_e","dateHeader","_f","_g","label","isInstance","request","endpointV2","properties","authSchemes","sent","sign","signingDate","systemClockOffset","signingRegion","signingService","apply","concat","catch","error","serverTime","ServerTime","getDateHeader","$response","response","headers","date","Date","undefined","awsAuthMiddlewareOptions","name","tags","relation","toMiddleware","override","getAwsAuthPlugin","applyToStack","clientStack","addRelativeTo","getSigV4AuthPlugin"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,WAA9B,QAAiD,OAAjD;AACA,SAASC,WAAT,EAAsBC,YAAtB,QAA0C,wBAA1C;AACA,SAASC,oBAAT,QAAqC,8BAArC;AACA,SAASC,2BAAT,QAA4C,qCAA5C;AACA,OAAO,IAAIC,iBAAiB,GAAG,UAAUC,OAAV,EAAmB;AAC9C,SAAO,UAAUC,IAAV,EAAgBC,OAAhB,EAAyB;AAC5B,WAAO,UAAUC,IAAV,EAAgB;AACnB,UAAIC,EAAJ,EAAQC,EAAR,EAAYC,EAAZ;;AACA,aAAOb,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,YAAIc,UAAJ,EAAgBC,MAAhB,EAAwBC,MAAxB,EAAgCC,EAAhC,EAAoCC,EAApC,EAAwCC,UAAxC;;AACA,YAAIC,EAAJ;;AACA,eAAOnB,WAAW,CAAC,IAAD,EAAO,UAAUoB,EAAV,EAAc;AACnC,kBAAQA,EAAE,CAACC,KAAX;AACI,iBAAK,CAAL;AACI,kBAAI,CAACpB,WAAW,CAACqB,UAAZ,CAAuBb,IAAI,CAACc,OAA5B,CAAL,EACI,OAAO,CAAC,CAAD,EAAIhB,IAAI,CAACE,IAAD,CAAR,CAAP;AACJI,cAAAA,UAAU,GAAG,CAACD,EAAE,GAAG,CAACD,EAAE,GAAG,CAACD,EAAE,GAAIF,OAAO,CAACgB,UAAf,MAAgC,IAAhC,IAAwCd,EAAE,KAAK,KAAK,CAApD,GAAwD,KAAK,CAA7D,GAAiEA,EAAE,CAACe,UAA1E,MAA0F,IAA1F,IAAkGd,EAAE,KAAK,KAAK,CAA9G,GAAkH,KAAK,CAAvH,GAA2HA,EAAE,CAACe,WAApI,MAAqJ,IAArJ,IAA6Jd,EAAE,KAAK,KAAK,CAAzK,GAA6K,KAAK,CAAlL,GAAsLA,EAAE,CAAC,CAAD,CAArM;AACA,qBAAO,CAAC,CAAD,EAAIN,OAAO,CAACQ,MAAR,CAAeD,UAAf,CAAJ,CAAP;;AACJ,iBAAK,CAAL;AACIC,cAAAA,MAAM,GAAGM,EAAE,CAACO,IAAH,EAAT;AACAX,cAAAA,EAAE,GAAGT,IAAL;AACAU,cAAAA,EAAE,GAAG,CAACnB,QAAQ,CAAC,EAAD,EAAKW,IAAL,CAAT,CAAL;AACAU,cAAAA,EAAE,GAAG,EAAL;AACA,qBAAO,CAAC,CAAD,EAAIL,MAAM,CAACc,IAAP,CAAYnB,IAAI,CAACc,OAAjB,EAA0B;AAC7BM,gBAAAA,WAAW,EAAE1B,oBAAoB,CAACG,OAAO,CAACwB,iBAAT,CADJ;AAE7BC,gBAAAA,aAAa,EAAEvB,OAAO,CAAC,gBAAD,CAFO;AAG7BwB,gBAAAA,cAAc,EAAExB,OAAO,CAAC,iBAAD;AAHM,eAA1B,CAAJ,CAAP;;AAKJ,iBAAK,CAAL;AAAQ,qBAAO,CAAC,CAAD,EAAIQ,EAAE,CAACiB,KAAH,CAAS,KAAK,CAAd,EAAiB,CAACnC,QAAQ,CAACmC,KAAT,CAAe,KAAK,CAApB,EAAuBhB,EAAE,CAACiB,MAAH,CAAU,EAAEf,EAAE,CAACI,OAAH,GAAaH,EAAE,CAACO,IAAH,EAAb,EAAwBR,EAA1B,EAAV,CAAvB,CAAD,CAAjB,EAAsFgB,KAAtF,CAA4F,UAAUC,KAAV,EAAiB;AACxH,oBAAI1B,EAAJ;;AACA,oBAAI2B,UAAU,GAAG,CAAC3B,EAAE,GAAG0B,KAAK,CAACE,UAAZ,MAA4B,IAA5B,IAAoC5B,EAAE,KAAK,KAAK,CAAhD,GAAoDA,EAApD,GAAyD6B,aAAa,CAACH,KAAK,CAACI,SAAP,CAAvF;;AACA,oBAAIH,UAAJ,EAAgB;AACZ/B,kBAAAA,OAAO,CAACwB,iBAAR,GAA4B1B,2BAA2B,CAACiC,UAAD,EAAa/B,OAAO,CAACwB,iBAArB,CAAvD;AACH;;AACD,sBAAMM,KAAN;AACH,eAPc,CAAJ,CAAP;;AAQR,iBAAK,CAAL;AACIrB,cAAAA,MAAM,GAAGK,EAAE,CAACO,IAAH,EAAT;AACAT,cAAAA,UAAU,GAAGqB,aAAa,CAACxB,MAAM,CAAC0B,QAAR,CAA1B;;AACA,kBAAIvB,UAAJ,EAAgB;AACZZ,gBAAAA,OAAO,CAACwB,iBAAR,GAA4B1B,2BAA2B,CAACc,UAAD,EAAaZ,OAAO,CAACwB,iBAArB,CAAvD;AACH;;AACD,qBAAO,CAAC,CAAD,EAAIf,MAAJ,CAAP;AA9BR;AAgCH,SAjCiB,CAAlB;AAkCH,OArCe,CAAhB;AAsCH,KAxCD;AAyCH,GA1CD;AA2CH,CA5CM;;AA6CP,IAAIwB,aAAa,GAAG,UAAUE,QAAV,EAAoB;AAAE,MAAI/B,EAAJ,EAAQC,EAAR,EAAYC,EAAZ;;AAAgB,SAAOV,YAAY,CAACoB,UAAb,CAAwBmB,QAAxB,IAAoC,CAAC9B,EAAE,GAAG,CAACD,EAAE,GAAG+B,QAAQ,CAACC,OAAf,MAA4B,IAA5B,IAAoChC,EAAE,KAAK,KAAK,CAAhD,GAAoD,KAAK,CAAzD,GAA6DA,EAAE,CAACiC,IAAtE,MAAgF,IAAhF,IAAwFhC,EAAE,KAAK,KAAK,CAApG,GAAwGA,EAAxG,GAA6G,CAACC,EAAE,GAAG6B,QAAQ,CAACC,OAAf,MAA4B,IAA5B,IAAoC9B,EAAE,KAAK,KAAK,CAAhD,GAAoD,KAAK,CAAzD,GAA6DA,EAAE,CAACgC,IAAjN,GAAwNC,SAA/N;AAA2O,CAArS;;AACA,OAAO,IAAIC,wBAAwB,GAAG;AAClCC,EAAAA,IAAI,EAAE,mBAD4B;AAElCC,EAAAA,IAAI,EAAE,CAAC,WAAD,EAAc,SAAd,CAF4B;AAGlCC,EAAAA,QAAQ,EAAE,OAHwB;AAIlCC,EAAAA,YAAY,EAAE,iBAJoB;AAKlCC,EAAAA,QAAQ,EAAE;AALwB,CAA/B;AAOP,OAAO,IAAIC,gBAAgB,GAAG,UAAU9C,OAAV,EAAmB;AAAE,SAAQ;AACvD+C,IAAAA,YAAY,EAAE,UAAUC,WAAV,EAAuB;AACjCA,MAAAA,WAAW,CAACC,aAAZ,CAA0BlD,iBAAiB,CAACC,OAAD,CAA3C,EAAsDwC,wBAAtD;AACH;AAHsD,GAAR;AAI9C,CAJE;AAKP,OAAO,IAAIU,kBAAkB,GAAGJ,gBAAzB","sourcesContent":["import { __assign, __awaiter, __generator } from \"tslib\";\nimport { HttpRequest, HttpResponse } from \"@aws-sdk/protocol-http\";\nimport { getSkewCorrectedDate } from \"./utils/getSkewCorrectedDate\";\nimport { getUpdatedSystemClockOffset } from \"./utils/getUpdatedSystemClockOffset\";\nexport var awsAuthMiddleware = function (options) {\n    return function (next, context) {\n        return function (args) {\n            var _a, _b, _c;\n            return __awaiter(this, void 0, void 0, function () {\n                var authScheme, signer, output, _d, _e, dateHeader;\n                var _f;\n                return __generator(this, function (_g) {\n                    switch (_g.label) {\n                        case 0:\n                            if (!HttpRequest.isInstance(args.request))\n                                return [2, next(args)];\n                            authScheme = (_c = (_b = (_a = (context.endpointV2)) === null || _a === void 0 ? void 0 : _a.properties) === null || _b === void 0 ? void 0 : _b.authSchemes) === null || _c === void 0 ? void 0 : _c[0];\n                            return [4, options.signer(authScheme)];\n                        case 1:\n                            signer = _g.sent();\n                            _d = next;\n                            _e = [__assign({}, args)];\n                            _f = {};\n                            return [4, signer.sign(args.request, {\n                                    signingDate: getSkewCorrectedDate(options.systemClockOffset),\n                                    signingRegion: context[\"signing_region\"],\n                                    signingService: context[\"signing_service\"],\n                                })];\n                        case 2: return [4, _d.apply(void 0, [__assign.apply(void 0, _e.concat([(_f.request = _g.sent(), _f)]))]).catch(function (error) {\n                                var _a;\n                                var serverTime = (_a = error.ServerTime) !== null && _a !== void 0 ? _a : getDateHeader(error.$response);\n                                if (serverTime) {\n                                    options.systemClockOffset = getUpdatedSystemClockOffset(serverTime, options.systemClockOffset);\n                                }\n                                throw error;\n                            })];\n                        case 3:\n                            output = _g.sent();\n                            dateHeader = getDateHeader(output.response);\n                            if (dateHeader) {\n                                options.systemClockOffset = getUpdatedSystemClockOffset(dateHeader, options.systemClockOffset);\n                            }\n                            return [2, output];\n                    }\n                });\n            });\n        };\n    };\n};\nvar getDateHeader = function (response) { var _a, _b, _c; return HttpResponse.isInstance(response) ? (_b = (_a = response.headers) === null || _a === void 0 ? void 0 : _a.date) !== null && _b !== void 0 ? _b : (_c = response.headers) === null || _c === void 0 ? void 0 : _c.Date : undefined; };\nexport var awsAuthMiddlewareOptions = {\n    name: \"awsAuthMiddleware\",\n    tags: [\"SIGNATURE\", \"AWSAUTH\"],\n    relation: \"after\",\n    toMiddleware: \"retryMiddleware\",\n    override: true,\n};\nexport var getAwsAuthPlugin = function (options) { return ({\n    applyToStack: function (clientStack) {\n        clientStack.addRelativeTo(awsAuthMiddleware(options), awsAuthMiddlewareOptions);\n    },\n}); };\nexport var getSigV4AuthPlugin = getAwsAuthPlugin;\n"]},"metadata":{},"sourceType":"module"}